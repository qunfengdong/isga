<%args> #! -*- cperl -*-
 $pipeline_builder
 $cluster => undef
</%args>
<%perl>
if(defined $cluster){
  $pipeline_builder->update($cluster);
}
</%perl>
<& /PipelineBuilder/edit_workflow.mas, pipeline_builder => $pipeline_builder &>

<sys:script type="text/javascript" src="/include/js/jtip.js"></sys:script>
<sys:style type="text/css" media="screen">
  @import "/include/css/jtip.css";
</sys:style>
<sys:style type="text/css" media="screen">
  @import "/include/css/uni-form.css";
</sys:style>



<style> @import "/include/css/uni-form.css";    </style>
<sys:script type="text/javascript">
  function processComponents(cluster) {
    $.ajax({
      url: "/PipelineBuilder/ChooseComponent?pipeline_builder=<% $pipeline_builder %>&cluster="+cluster,
      success: function(html){
        $('#modal_content').append(html); 
      }
    });
    return false;
  }
</sys:script>


<sys:script type="text/javascript">
$(document).ready(modalUpdate);
function modalUpdate() {
  $('.modal').modal({hide_on_overlay_click:false});
}
</sys:script>



<sys:script type="text/javascript">
$(document).ready(wfUpdate);

function wfUpdate() {
  if($.browser.msie)
  {
  $("area.cluster")
   .hover(function(){JT_IE_area_show(this.href,this.id,this.title,this.coords,'workflow')},function(){$('#JT').remove()})
   .click(
     function(){
      $("#JT").remove();
      return false;
     });
  $("area.clusterOption")
   .hover(function(){JT_IE_area_show(this.href,this.id,this.title,this.coords,'workflow')},function(){$('#JT').remove()})
   .click(
     function(){
      $("#JT").remove();
      processComponents(this.id);
      return false;
    });
  }else{
  $("area.cluster")
   .hover(function(){JT_area_show(this.href,this.id,this.alt,this.coords)},function(){$('#JT').remove()})
   .click(
     function(){
      $("#JT").remove();
      return false;
     });
  $("area.clusterOption")
   .hover(function(){JT_area_show(this.href,this.id,this.alt,this.coords)},function(){$('#JT').remove()})
   .click(
     function(){
      $("#JT").remove();
      processComponents(this.id);
      return false;
    });
  }
}

</sys:script>
