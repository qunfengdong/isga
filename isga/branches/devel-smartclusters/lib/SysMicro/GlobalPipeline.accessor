# -*- cperl -*-
#------------------------------------------------------------------------

=item public undef getParameterMask();

Returns the parameter mask for this pipeline.

=cut
#------------------------------------------------------------------------
  sub getParameterMask { return undef; }

#------------------------------------------------------------------------

=item public ParameterMask getRawParameterMask();

Returns the string for the parameter mask for this pipeline. Useful
when you dont want to pay to load the YAML object.

=cut
#------------------------------------------------------------------------
  sub getRawParameterMask { return ''; }

#------------------------------------------------------------------------

=item public [Workflow] getWorkflow();

Returns the Workflow objects associated with this pipeline.

=cut
#------------------------------------------------------------------------
  sub getWorkflow { SysMicro::Workflow->query( Pipeline => shift ); }

#------------------------------------------------------------------------

=item public [Cluster] getClusters();

Convenience method to return a list of clusters in this pipeline.

=cut
#------------------------------------------------------------------------
  sub getClusters { 

    my $self = shift;
    return [map { $_->getCluster } @{$self->getWorkflow}];
  }

#------------------------------------------------------------------------

=item public [Component] getComponents();

Returns a list of components in this pipeline.

=item public [Component] getComponents(Cluster $cluster);

Returns a list of components in the provided cluster of this pipeline.

=cut
#------------------------------------------------------------------------
  sub getComponents { 

    my ($self, $cluster) = @_;

    if ( $cluster and SysMicro::Workflow->exists(Cluster => $cluster, Pipeline => $self )) {
      return SysMicro::Component->query(Cluster => $cluster);
    }
    
    return SysMicro::Component->query( Cluster => $self->getClusters );
  }
