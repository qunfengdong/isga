<%args> # -*- cperl -*-
 @active => ()
</%args>

<%perl>

# build a cache of active news posts
my $active = {};
$active->{$_} = 1 for @active;

my $type_map;

# query active news

my $news = SysMicro::News->query( IsArchived => 0, OrderBy => 'CreatedAt' );

while ( my $n = pop( @$news ) ) {
  push @{$type_map->{ $n->getType }}, $n;
}

</%perl>

<& /News/recent.mas, active => $active, type_map => $type_map &>
